"use strict";(self.webpackChunkdesign_angular_kit_bundle=self.webpackChunkdesign_angular_kit_bundle||[]).push([[8669],{8669:(W,d,l)=>{l.r(d),l.d(d,{UploadModule:()=>V});var v=l(6814),U=l(7114),L=l(6223),m=l(1640),u=l(7069),t=l(5879),F=l(528),y=l(6273),C=l(4580),I=l(6099),x=l(7715),D=l(4664),f=l(9397),T=l(9360),b=l(8251),c=l(7398),Z=l(6306),A=l(2096),w=l(4716),r=l(9862),g=l(2346);let J=(()=>{class o{constructor(n){this.httpClient=n,this.uploadedFileList=[{id:0,file:new File([],"nome-file-01.pdf")},{id:1,file:new File([],"nome-file-02-nome-file-lungo-per-ellissi.doc")},{id:2,file:new File([],"nome-file-03.png"),progress:43,removable:!0},{id:3,file:new File([],"nome-file-04.png"),error:!0,removable:!0}]}onUpdateFileList(n){const e=Array.from(n).map((i,a)=>({id:a+this.uploadedFileList.length,file:i,removable:!0}));this.uploadedFileList=[...this.uploadedFileList,...e]}onDeleteFileList(n){this.uploadedFileList=this.uploadedFileList.filter(e=>e.id!==n.id)}httpClientExample(){const n=this.uploadedFileList[0];n.progress=1,n.error=void 0,n.removable=!1,(0,x.D)(n.file.arrayBuffer()).pipe((0,D.w)(e=>{const i=[...new Uint8Array(e)];return this.httpClient.post("url",i,{reportProgress:!0,observe:"events"})}),(0,f.b)(e=>{e.type===r.dt.UploadProgress&&(n.progress=Math.round(e.loaded/(e.total||1)*100))}),function E(o){return(0,T.e)((p,n)=>{let e=!1,i=0;p.subscribe((0,b.x)(n,a=>(e||(e=!o(a,i++)))&&n.next(a)))})}(e=>e.type!==r.dt.Response),(0,c.U)(e=>e.body),(0,f.b)(e=>{n.progress=100}),(0,Z.K)(e=>(n.progress=void 0,n.removable=!0,n.error=!0,n.tooltip=e.message,(0,A.of)(null))),(0,w.x)(()=>{!n.error&&n.progress&&n.progress<100&&(n.progress=void 0,n.removable=!0,n.error=!0,n.tooltip="Incomplete upload error")}))}static#e=this.\u0275fac=function(e){return new(e||o)(t.Y36(r.eN))};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-file-list-example"]],decls:6,vars:1,consts:[[1,"bd-example"],[1,"row","my-2"],[1,"col"],[3,"fileList","uploadFiles","deleteItem"]],template:function(e,i){1&e&&(t.TgZ(0,"h3"),t._uU(1,"Upload con lista di file"),t.qZA(),t.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"it-upload-file-list",3),t.NdJ("uploadFiles",function(s){return i.onUpdateFileList(s)})("deleteItem",function(s){return i.onDeleteFileList(s)}),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("fileList",i.uploadedFileList))},dependencies:[g.O],encapsulation:2})}return o})();var H=l(9315);let S=(()=>{class o{constructor(n){this.httpClient=n,this.uploadedImageList=[]}ngOnInit(){const n=["https://picsum.photos/40/40?image=1055","https://picsum.photos/80/40?image=1056","https://picsum.photos/40/40?image=1057","https://picsum.photos/120/200?image=1058"].map(e=>this.httpClient.get(e,{responseType:"blob"}));(0,H.D)(n).subscribe(e=>{this.uploadedImageList=e.map((i,a)=>({id:a,file:new File([i],1===a?"nome-file-2-nome-file-lungo-per-ellissi.jpg":`nome-file-${a+1}.jpg`),removable:a>1,progress:2===a?45:void 0,error:3===a}))})}onUpdateImageList(n){const e=Array.from(n).map((i,a)=>({id:a+this.uploadedImageList.length,file:i,removable:!0}));this.uploadedImageList=[...this.uploadedImageList,...e]}onDeleteImageList(n){this.uploadedImageList=this.uploadedImageList.filter(e=>e.id!==n.id)}static#e=this.\u0275fac=function(e){return new(e||o)(t.Y36(r.eN))};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-image-list-example"]],decls:6,vars:1,consts:[[1,"bd-example"],[1,"row","my-2"],[1,"col"],["images","true",3,"fileList","uploadFiles","deleteItem"]],template:function(e,i){1&e&&(t.TgZ(0,"h3"),t._uU(1,"Con anteprima delle immagini"),t.qZA(),t.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"it-upload-file-list",3),t.NdJ("uploadFiles",function(s){return i.onUpdateImageList(s)})("deleteItem",function(s){return i.onDeleteImageList(s)}),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("fileList",i.uploadedImageList))},dependencies:[g.O],encapsulation:2})}return o})();var h=l(6321),B=l(5592),M=l(671);var z=l(8180),P=l(3342);const Q=["uploadDragDropComponent"];let O=(()=>{class o{onDragUploadStart(n){(function j(o=0,p=h.z){return o<0&&(o=0),function $(o=0,p,n=h.P){let e=-1;return null!=p&&((0,M.K)(p)?n=p:e=p),new B.y(i=>{let a=function N(o){return o instanceof Date&&!isNaN(o)}(o)?+o-n.now():o;a<0&&(a=0);let s=0;return n.schedule(function(){i.closed||(i.next(s++),0<=e?this.schedule(void 0,e):i.complete())},a)})}(o,o,p)})(1e3).pipe((0,z.q)(100),(0,c.U)(e=>10*(e+1))).subscribe(e=>{this.uploadDragDropComponent.progress(e),e>=100&&setTimeout(()=>{this.uploadDragDropComponent.reset()},2e3)})}static#e=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-drag-drop-example"]],viewQuery:function(e,i){if(1&e&&t.Gf(Q,5),2&e){let a;t.iGM(a=t.CRH())&&(i.uploadDragDropComponent=a.first)}},decls:7,vars:0,consts:[[1,"bd-example"],[1,"row","my-2"],[1,"col"],[3,"fileStartUpload"],["uploadDragDropComponent",""]],template:function(e,i){1&e&&(t.TgZ(0,"h3"),t._uU(1,"Upload Drag&drop"),t.qZA(),t.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"it-upload-drag-drop",3,4),t.NdJ("fileStartUpload",function(s){return i.onDragUploadStart(s)}),t.qZA()()()())},dependencies:[P.T],encapsulation:2})}return o})(),R=(()=>{class o{static#e=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-examples"]],decls:6,vars:0,consts:[["html",'<h3>Upload con lista di file</h3>\n<div class="bd-example">\n  <div class="row my-2">\n    <div class="col">\n      <it-upload-file-list [fileList]="uploadedFileList"\n                           (uploadFiles)="onUpdateFileList($event)"\n                           (deleteItem)="onDeleteFileList($event)"></it-upload-file-list>\n    </div>\n  </div>\n</div>',"typescript","import {Component} from '@angular/core';\nimport {UploadFileListItem} from \"design-angular-kit/interfaces/form\";\nimport {catchError, finalize, from, map, of, skipWhile, switchMap, tap} from \"rxjs\";\nimport {HttpClient, HttpEventType, HttpResponse} from \"@angular/common/http\";\n\n@Component({\n  selector: 'it-upload-file-list-example',\n  templateUrl: './upload-file-list-example.component.html'\n})\nexport class UploadFileListExampleComponent {\n\n  uploadedFileList: Array<UploadFileListItem> = [\n    {\n      id: 0,\n      file: new File([], 'nome-file-01.pdf'),\n    },\n    {\n      id: 1,\n      file: new File([], 'nome-file-02-nome-file-lungo-per-ellissi.doc'),\n    },\n    {\n      id: 2,\n      file: new File([], 'nome-file-03.png'),\n      progress: 43,\n      removable: true\n    },\n    {\n      id: 3,\n      file: new File([], 'nome-file-04.png'),\n      error: true,\n      removable: true\n    }\n  ];\n\n\n  constructor(\n    private readonly httpClient: HttpClient\n  ) {\n  }\n\n\n  onUpdateFileList(files: FileList): void {\n    const newFiles: Array<UploadFileListItem> = Array.from(files).map((file, index) => ({\n      id: (index + this.uploadedFileList.length), // I set an id, useful when deleting\n      file, // The uploaded file\n      removable: true // set new file as removable\n    }));\n\n    this.uploadedFileList = [...this.uploadedFileList, ...newFiles];\n  }\n\n  onDeleteFileList(item: UploadFileListItem): void {\n    this.uploadedFileList = this.uploadedFileList.filter(i => i.id !== item.id);\n  }\n\n  /**\n   * Example to upload file with HttpClient\n   */\n  httpClientExample(): void {\n    const fileToUpload = this.uploadedFileList[0];\n    fileToUpload.progress = 1;\n    fileToUpload.error = undefined;\n    fileToUpload.removable = false;\n\n    from(fileToUpload.file.arrayBuffer()).pipe( // Converting the file to arrayBuffer\n      switchMap(arrayBuffer => {\n        const bytes = [...new Uint8Array(arrayBuffer)]; // Convert arrayBuffer to Array<number>\n\n        // NOTE: File conversion depends on your server / API\n        // If you want to transform the file to base64 you can use the helper function\n        // import {FileUtils} from \"design-angular-kit\";\n        // const base64 = FileUtils.fileToBase64(fileToUpload.file)\n\n        return this.httpClient.post<any>('url', bytes, {\n          reportProgress: true,\n          observe: 'events'\n        })\n      }),\n      tap(event => { // Update the progress request status\n        if (event.type === HttpEventType.UploadProgress) {\n          fileToUpload.progress = Math.round(event.loaded / (event.total || 1) * 100);\n        }\n      }),\n      skipWhile(event => event.type !== HttpEventType.Response), // skip while the request not is complete\n      map(event => (event as HttpResponse<any>).body), // request is complete with body\n      tap(uploadedFile => {\n        fileToUpload.progress = 100;\n      }),\n      catchError(error => {\n        fileToUpload.progress = undefined;\n        fileToUpload.removable = true;\n        fileToUpload.error = true;\n        fileToUpload.tooltip = error.message; // Show error message as tooltip\n        return of(null); // File upload failed\n      }),\n      finalize(() => {\n        if (!fileToUpload.error && fileToUpload.progress && fileToUpload.progress < 100) {\n          // There are no errors but the file upload is not complete\n          fileToUpload.progress = undefined;\n          fileToUpload.removable = true;\n          fileToUpload.error = true;\n          fileToUpload.tooltip = 'Incomplete upload error'; // Show error message as tooltip\n        }\n      })\n    );\n\n  }\n}"],["html",'<h3>Con anteprima delle immagini</h3>\n<div class="bd-example">\n  <div class="row my-2">\n    <div class="col">\n      <it-upload-file-list [fileList]="uploadedImageList"\n                           images="true"\n                           (uploadFiles)="onUpdateImageList($event)"\n                           (deleteItem)="onDeleteImageList($event)"></it-upload-file-list>\n    </div>\n  </div>\n</div>',"typescript","import {Component, OnInit} from '@angular/core';\nimport {UploadFileListItem} from \"design-angular-kit/interfaces/form\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {forkJoin} from \"rxjs\";\n\n@Component({\n  selector: 'it-upload-image-list-example',\n  templateUrl: './upload-image-list-example.component.html'\n})\nexport class UploadImageListExampleComponent implements OnInit {\n\n  uploadedImageList: Array<UploadFileListItem> = [];\n\n  constructor(\n    private readonly httpClient: HttpClient\n  ) {\n  }\n\n  ngOnInit() {\n    const images$ = [\n      'https://picsum.photos/40/40?image=1055',\n      'https://picsum.photos/80/40?image=1056',\n      'https://picsum.photos/40/40?image=1057',\n      'https://picsum.photos/120/200?image=1058'\n    ].map(url => this.httpClient.get(url, {responseType: \"blob\"}));\n\n    forkJoin(images$).subscribe((blobImages) => {\n      this.uploadedImageList = blobImages.map((blob, index) => {\n        const fileName = index === 1 ? 'nome-file-2-nome-file-lungo-per-ellissi.jpg' : `nome-file-${index + 1}.jpg`;\n        return {\n          id: index,\n          file: new File([blob], fileName),\n          removable: index > 1,\n          progress: index === 2 ? 45 : undefined,\n          error: index === 3\n        }\n      })\n    });\n  }\n\n  onUpdateImageList(files: FileList): void {\n    const newFiles: Array<UploadFileListItem> = Array.from(files).map((file, index) => ({\n      id: (index + this.uploadedImageList.length), // I set an id, useful when deleting\n      file, // The uploaded file\n      removable: true // set new file as removable\n    }));\n\n    this.uploadedImageList = [...this.uploadedImageList, ...newFiles];\n  }\n\n  onDeleteImageList(item: UploadFileListItem): void {\n    this.uploadedImageList = this.uploadedImageList.filter(i => i.id !== item.id);\n  }\n}"],["html",'<h3>Upload Drag&drop</h3>\n<div class="bd-example">\n  <div class="row my-2">\n    <div class="col">\n      <it-upload-drag-drop (fileStartUpload)="onDragUploadStart($event)"\n                           #uploadDragDropComponent></it-upload-drag-drop>\n    </div>\n  </div>\n</div>',"typescript","import {Component, ViewChild} from '@angular/core';\nimport {interval, map, take} from \"rxjs\";\nimport {\n  ItUploadDragDropComponent\n} from \"design-angular-kit/components/form/upload-drag-drop/upload-drag-drop.component\";\n\n@Component({\n  selector: 'it-upload-drag-drop-example',\n  templateUrl: './upload-drag-drop-example.component.html'\n})\nexport class UploadDragDropExampleComponent {\n\n  @ViewChild('uploadDragDropComponent') uploadDragDropComponent!: ItUploadDragDropComponent;\n\n  onDragUploadStart(file: File): void {\n    interval(1000).pipe( // Simulate upload of single file\n      take(100),\n      map(x => (x + 1) * 10) // Start from 1, end 100\n    ).subscribe(progress => {\n      this.uploadDragDropComponent.progress(progress);\n      if (progress >= 100) {\n        setTimeout(() => {\n          this.uploadDragDropComponent.reset();\n        }, 2000);\n      }\n    });\n  }\n\n}"]],template:function(e,i){1&e&&t._UZ(0,"it-upload-file-list-example")(1,"it-source-display",0)(2,"it-upload-image-list-example")(3,"it-source-display",1)(4,"it-upload-drag-drop-example")(5,"it-source-display",2)},dependencies:[I.F,J,S,O],encapsulation:2})}return o})();const X=[{path:"",component:(()=>{class o{constructor(){this.fileListComponent=u.wx.find(n=>"ItUploadFileListComponent"===n.name),this.dragDropComponent=u.wx.find(n=>"ItUploadDragDropComponent"===n.name)}static#e=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-index"]],decls:15,vars:3,consts:[[1,"bd-title"],[1,"bd-lead"],[3,"innerHTML"],["label","Esempi","active","true",1,"mt-3"],["label","API",1,"mt-3"],[3,"component"]],template:function(e,i){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Upload"),t.qZA(),t.TgZ(2,"p",1),t._uU(3,"Elementi dei form dedicati al caricamento file."),t.qZA(),t._UZ(4,"div",2),t.TgZ(5,"it-tab-container")(6,"it-tab-item",3),t._UZ(7,"it-upload-examples"),t.qZA(),t.TgZ(8,"it-tab-item",4)(9,"h2"),t._uU(10,"Upload con lista di file"),t.qZA(),t._UZ(11,"it-api-parameters",5),t.TgZ(12,"h2"),t._uU(13,"Upload Drag&drop"),t.qZA(),t._UZ(14,"it-api-parameters",5),t.qZA()()),2&e&&(t.xp6(4),t.Q6J("innerHTML",i.fileListComponent.description,t.oJD),t.xp6(7),t.Q6J("component",i.fileListComponent),t.xp6(3),t.Q6J("component",i.dragDropComponent))},dependencies:[F.G,y.U,C.m,R],encapsulation:2})}return o})()}];let G=(()=>{class o{static#e=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(X),m.Bz]})}return o})(),V=(()=>{class o{static#e=this.\u0275fac=function(e){return new(e||o)};static#t=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[v.ez,U.m,L.u5,G]})}return o})()}}]);