"use strict";(self.webpackChunkdesign_angular_kit_bundle=self.webpackChunkdesign_angular_kit_bundle||[]).push([[669],{8669:(W,d,l)=>{l.r(d),l.d(d,{UploadModule:()=>V});var U=l(6814),v=l(4244),L=l(6223),m=l(258),u=l(7069),t=l(2029),F=l(528),C=l(6273),x=l(4580),y=l(6099),I=l(7715),D=l(4664),f=l(9397),T=l(9360),b=l(8251),g=l(7398),Z=l(6306),A=l(2096),w=l(4716),s=l(9862),c=l(2346);let M=(()=>{class o{constructor(e){this.httpClient=e,this.uploadedFileList=[{id:0,file:new File([],"nome-file-01.pdf")},{id:1,file:new File([],"nome-file-02-nome-file-lungo-per-ellissi.doc")},{id:2,file:new File([],"nome-file-03.png"),progress:43,removable:!0},{id:3,file:new File([],"nome-file-04.png"),error:!0,removable:!0}]}onUpdateFileList(e){const n=Array.from(e).map((p,a)=>({id:a+this.uploadedFileList.length,file:p,removable:!0}));this.uploadedFileList=[...this.uploadedFileList,...n]}onDeleteFileList(e){this.uploadedFileList=this.uploadedFileList.filter(n=>n.id!==e.id)}httpClientExample(){const e=this.uploadedFileList[0];e.progress=1,e.error=void 0,e.removable=!1,(0,I.D)(e.file.arrayBuffer()).pipe((0,D.w)(n=>{const p=[...new Uint8Array(n)];return this.httpClient.post("url",p,{reportProgress:!0,observe:"events"})}),(0,f.b)(n=>{n.type===s.dt.UploadProgress&&(e.progress=Math.round(n.loaded/(n.total||1)*100))}),function E(o){return(0,T.e)((i,e)=>{let n=!1,p=0;i.subscribe((0,b.x)(e,a=>(n||(n=!o(a,p++)))&&e.next(a)))})}(n=>n.type!==s.dt.Response),(0,g.U)(n=>n.body),(0,f.b)(n=>{e.progress=100}),(0,Z.K)(n=>(e.progress=void 0,e.removable=!0,e.error=!0,e.tooltip=n.message,(0,A.of)(null))),(0,w.x)(()=>{!e.error&&e.progress&&e.progress<100&&(e.progress=void 0,e.removable=!0,e.error=!0,e.tooltip="Incomplete upload error")}))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(s.eN))},o.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-file-list-example"]],decls:6,vars:1,consts:[[1,"bd-example"],[1,"row","my-2"],[1,"col"],[3,"fileList","uploadFiles","deleteItem"]],template:function(e,n){1&e&&(t.TgZ(0,"h3"),t._uU(1,"Upload con lista di file"),t.qZA(),t.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"it-upload-file-list",3),t.NdJ("uploadFiles",function(a){return n.onUpdateFileList(a)})("deleteItem",function(a){return n.onDeleteFileList(a)}),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("fileList",n.uploadedFileList))},dependencies:[c.O],encapsulation:2}),o})();var J=l(9315);let H=(()=>{class o{constructor(e){this.httpClient=e,this.uploadedImageList=[]}ngOnInit(){const e=["https://picsum.photos/40/40?image=1055","https://picsum.photos/80/40?image=1056","https://picsum.photos/40/40?image=1057","https://picsum.photos/120/200?image=1058"].map(n=>this.httpClient.get(n,{responseType:"blob"}));(0,J.D)(e).subscribe(n=>{this.uploadedImageList=n.map((p,a)=>({id:a,file:new File([p],1===a?"nome-file-2-nome-file-lungo-per-ellissi.jpg":`nome-file-${a+1}.jpg`),removable:a>1,progress:2===a?45:void 0,error:3===a}))})}onUpdateImageList(e){const n=Array.from(e).map((p,a)=>({id:a+this.uploadedImageList.length,file:p,removable:!0}));this.uploadedImageList=[...this.uploadedImageList,...n]}onDeleteImageList(e){this.uploadedImageList=this.uploadedImageList.filter(n=>n.id!==e.id)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(s.eN))},o.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-image-list-example"]],decls:6,vars:1,consts:[[1,"bd-example"],[1,"row","my-2"],[1,"col"],["images","true",3,"fileList","uploadFiles","deleteItem"]],template:function(e,n){1&e&&(t.TgZ(0,"h3"),t._uU(1,"Con anteprima delle immagini"),t.qZA(),t.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"it-upload-file-list",3),t.NdJ("uploadFiles",function(a){return n.onUpdateImageList(a)})("deleteItem",function(a){return n.onDeleteImageList(a)}),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("fileList",n.uploadedImageList))},dependencies:[c.O],encapsulation:2}),o})();var h=l(6321),S=l(5592),j=l(671);var R=l(8180),z=l(3342);const P=["uploadDragDropComponent"];let Q=(()=>{class o{onDragUploadStart(e){(function $(o=0,i=h.z){return o<0&&(o=0),function N(o=0,i,e=h.P){let n=-1;return null!=i&&((0,j.K)(i)?e=i:n=i),new S.y(p=>{let a=function B(o){return o instanceof Date&&!isNaN(o)}(o)?+o-e.now():o;a<0&&(a=0);let r=0;return e.schedule(function(){p.closed||(p.next(r++),0<=n?this.schedule(void 0,n):p.complete())},a)})}(o,o,i)})(1e3).pipe((0,R.q)(100),(0,g.U)(n=>10*(n+1))).subscribe(n=>{this.uploadDragDropComponent.progress(n),n>=100&&setTimeout(()=>{this.uploadDragDropComponent.reset()},2e3)})}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-drag-drop-example"]],viewQuery:function(e,n){if(1&e&&t.Gf(P,5),2&e){let p;t.iGM(p=t.CRH())&&(n.uploadDragDropComponent=p.first)}},decls:7,vars:0,consts:[[1,"bd-example"],[1,"row","my-2"],[1,"col"],[3,"fileStartUpload"],["uploadDragDropComponent",""]],template:function(e,n){1&e&&(t.TgZ(0,"h3"),t._uU(1,"Upload Drag&drop"),t.qZA(),t.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"it-upload-drag-drop",3,4),t.NdJ("fileStartUpload",function(a){return n.onDragUploadStart(a)}),t.qZA()()()())},dependencies:[z.T],encapsulation:2}),o})(),O=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-examples"]],decls:6,vars:0,consts:[["html",'<h3>Upload con lista di file</h3>\n<div class="bd-example">\n  <div class="row my-2">\n    <div class="col">\n      <it-upload-file-list [fileList]="uploadedFileList"\n                           (uploadFiles)="onUpdateFileList($event)"\n                           (deleteItem)="onDeleteFileList($event)"></it-upload-file-list>\n    </div>\n  </div>\n</div>',"typescript","import {Component} from '@angular/core';\nimport {UploadFileListItem} from \"../../../../projects/design-angular-kit/src/lib/interfaces/form\";\nimport {catchError, finalize, from, map, of, skipWhile, switchMap, tap} from \"rxjs\";\nimport {HttpClient, HttpEventType, HttpResponse} from \"@angular/common/http\";\n\n@Component({\n  selector: 'it-upload-file-list-example',\n  templateUrl: './upload-file-list-example.component.html'\n})\nexport class UploadFileListExampleComponent {\n\n  uploadedFileList: Array<UploadFileListItem> = [\n    {\n      id: 0,\n      file: new File([], 'nome-file-01.pdf'),\n    },\n    {\n      id: 1,\n      file: new File([], 'nome-file-02-nome-file-lungo-per-ellissi.doc'),\n    },\n    {\n      id: 2,\n      file: new File([], 'nome-file-03.png'),\n      progress: 43,\n      removable: true\n    },\n    {\n      id: 3,\n      file: new File([], 'nome-file-04.png'),\n      error: true,\n      removable: true\n    }\n  ];\n\n\n  constructor(\n    private readonly httpClient: HttpClient\n  ) {\n  }\n\n\n  onUpdateFileList(files: FileList): void {\n    const newFiles: Array<UploadFileListItem> = Array.from(files).map((file, index) => ({\n      id: (index + this.uploadedFileList.length), // I set an id, useful when deleting\n      file, // The uploaded file\n      removable: true // set new file as removable\n    }));\n\n    this.uploadedFileList = [...this.uploadedFileList, ...newFiles];\n  }\n\n  onDeleteFileList(item: UploadFileListItem): void {\n    this.uploadedFileList = this.uploadedFileList.filter(i => i.id !== item.id);\n  }\n\n  /**\n   * Example to upload file with HttpClient\n   */\n  httpClientExample(): void {\n    const fileToUpload = this.uploadedFileList[0];\n    fileToUpload.progress = 1;\n    fileToUpload.error = undefined;\n    fileToUpload.removable = false;\n\n    from(fileToUpload.file.arrayBuffer()).pipe( // Converting the file to arrayBuffer\n      switchMap(arrayBuffer => {\n        const bytes = [...new Uint8Array(arrayBuffer)]; // Convert arrayBuffer to Array<number>\n\n        // NOTE: File conversion depends on your server / API\n        // If you want to transform the file to base64 you can use the helper function\n        // import {FileUtils} from \"design-angular-kit\";\n        // const base64 = FileUtils.fileToBase64(fileToUpload.file)\n\n        return this.httpClient.post<any>('url', bytes, {\n          reportProgress: true,\n          observe: 'events'\n        })\n      }),\n      tap(event => { // Update the progress request status\n        if (event.type === HttpEventType.UploadProgress) {\n          fileToUpload.progress = Math.round(event.loaded / (event.total || 1) * 100);\n        }\n      }),\n      skipWhile(event => event.type !== HttpEventType.Response), // skip while the request not is complete\n      map(event => (event as HttpResponse<any>).body), // request is complete with body\n      tap(uploadedFile => {\n        fileToUpload.progress = 100;\n      }),\n      catchError(error => {\n        fileToUpload.progress = undefined;\n        fileToUpload.removable = true;\n        fileToUpload.error = true;\n        fileToUpload.tooltip = error.message; // Show error message as tooltip\n        return of(null); // File upload failed\n      }),\n      finalize(() => {\n        if (!fileToUpload.error && fileToUpload.progress && fileToUpload.progress < 100) {\n          // There are no errors but the file upload is not complete\n          fileToUpload.progress = undefined;\n          fileToUpload.removable = true;\n          fileToUpload.error = true;\n          fileToUpload.tooltip = 'Incomplete upload error'; // Show error message as tooltip\n        }\n      })\n    );\n\n  }\n}"],["html",'<h3>Con anteprima delle immagini</h3>\n<div class="bd-example">\n  <div class="row my-2">\n    <div class="col">\n      <it-upload-file-list [fileList]="uploadedImageList"\n                           images="true"\n                           (uploadFiles)="onUpdateImageList($event)"\n                           (deleteItem)="onDeleteImageList($event)"></it-upload-file-list>\n    </div>\n  </div>\n</div>',"typescript","import {Component, OnInit} from '@angular/core';\nimport {UploadFileListItem} from \"../../../../projects/design-angular-kit/src/lib/interfaces/form\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {forkJoin} from \"rxjs\";\n\n@Component({\n  selector: 'it-upload-image-list-example',\n  templateUrl: './upload-image-list-example.component.html'\n})\nexport class UploadImageListExampleComponent implements OnInit {\n\n  uploadedImageList: Array<UploadFileListItem> = [];\n\n  constructor(\n    private readonly httpClient: HttpClient\n  ) {\n  }\n\n  ngOnInit() {\n    const images$ = [\n      'https://picsum.photos/40/40?image=1055',\n      'https://picsum.photos/80/40?image=1056',\n      'https://picsum.photos/40/40?image=1057',\n      'https://picsum.photos/120/200?image=1058'\n    ].map(url => this.httpClient.get(url, {responseType: \"blob\"}));\n\n    forkJoin(images$).subscribe((blobImages) => {\n      this.uploadedImageList = blobImages.map((blob, index) => {\n        const fileName = index === 1 ? 'nome-file-2-nome-file-lungo-per-ellissi.jpg' : `nome-file-${index + 1}.jpg`;\n        return {\n          id: index,\n          file: new File([blob], fileName),\n          removable: index > 1,\n          progress: index === 2 ? 45 : undefined,\n          error: index === 3\n        }\n      })\n    });\n  }\n\n  onUpdateImageList(files: FileList): void {\n    const newFiles: Array<UploadFileListItem> = Array.from(files).map((file, index) => ({\n      id: (index + this.uploadedImageList.length), // I set an id, useful when deleting\n      file, // The uploaded file\n      removable: true // set new file as removable\n    }));\n\n    this.uploadedImageList = [...this.uploadedImageList, ...newFiles];\n  }\n\n  onDeleteImageList(item: UploadFileListItem): void {\n    this.uploadedImageList = this.uploadedImageList.filter(i => i.id !== item.id);\n  }\n}"],["html",'<h3>Upload Drag&drop</h3>\n<div class="bd-example">\n  <div class="row my-2">\n    <div class="col">\n      <it-upload-drag-drop (fileStartUpload)="onDragUploadStart($event)"\n                           #uploadDragDropComponent></it-upload-drag-drop>\n    </div>\n  </div>\n</div>',"typescript","import {Component, ViewChild} from '@angular/core';\nimport {interval, map, take} from \"rxjs\";\nimport {\n  ItUploadDragDropComponent\n} from \"../../../../projects/design-angular-kit/src/lib/components/form/upload-drag-drop/upload-drag-drop.component\";\n\n@Component({\n  selector: 'it-upload-drag-drop-example',\n  templateUrl: './upload-drag-drop-example.component.html'\n})\nexport class UploadDragDropExampleComponent {\n\n  @ViewChild('uploadDragDropComponent') uploadDragDropComponent!: ItUploadDragDropComponent;\n\n  onDragUploadStart(file: File): void {\n    interval(1000).pipe( // Simulate upload of single file\n      take(100),\n      map(x => (x + 1) * 10) // Start from 1, end 100\n    ).subscribe(progress => {\n      this.uploadDragDropComponent.progress(progress);\n      if (progress >= 100) {\n        setTimeout(() => {\n          this.uploadDragDropComponent.reset();\n        }, 2000);\n      }\n    });\n  }\n\n}"]],template:function(e,n){1&e&&t._UZ(0,"it-upload-file-list-example")(1,"it-source-display",0)(2,"it-upload-image-list-example")(3,"it-source-display",1)(4,"it-upload-drag-drop-example")(5,"it-source-display",2)},dependencies:[y.F,M,H,Q],encapsulation:2}),o})();const X=[{path:"",component:(()=>{class o{constructor(){this.fileListComponent=u.wx.find(e=>"ItUploadFileListComponent"===e.name),this.dragDropComponent=u.wx.find(e=>"ItUploadDragDropComponent"===e.name)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["it-upload-index"]],decls:15,vars:3,consts:[[1,"bd-title"],[1,"bd-lead"],[3,"innerHTML"],["label","Esempi","active","true",1,"mt-3"],["label","API",1,"mt-3"],[3,"component"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Upload"),t.qZA(),t.TgZ(2,"p",1),t._uU(3,"Elementi dei form dedicati al caricamento file."),t.qZA(),t._UZ(4,"div",2),t.TgZ(5,"it-tab-container")(6,"it-tab-item",3),t._UZ(7,"it-upload-examples"),t.qZA(),t.TgZ(8,"it-tab-item",4)(9,"h2"),t._uU(10,"Upload con lista di file"),t.qZA(),t._UZ(11,"it-api-parameters",5),t.TgZ(12,"h2"),t._uU(13,"Upload Drag&drop"),t.qZA(),t._UZ(14,"it-api-parameters",5),t.qZA()()),2&e&&(t.xp6(4),t.Q6J("innerHTML",n.fileListComponent.description,t.oJD),t.xp6(7),t.Q6J("component",n.fileListComponent),t.xp6(3),t.Q6J("component",n.dragDropComponent))},dependencies:[F.G,C.U,x.m,O],encapsulation:2}),o})()}];let G=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.Bz.forChild(X),m.Bz]}),o})(),V=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[U.ez,v.m,L.u5,G]}),o})()}}]);